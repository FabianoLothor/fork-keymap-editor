{"version":3,"file":"8371.f3862461b21b77cd6730.js","mappings":"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","sources":["webpack:///./src/Keyboard/Common/dragSelector.module.css?1c6f","webpack:///./src/Keyboard/Common/DragSelector.js","webpack:///./src/Keyboard/Common/KeyPositionSelector.js","webpack:///./src/Keyboard/layoutPropTypes.js","webpack:///./src/Keyboard/KeyPlacer.js","webpack:///./src/Keyboard/KeyboardLayout.js","webpack:///./src/Keyboard/Common/dragSelector.module.css","webpack:///./src/Keyboard/Common/keyPositionSelectorStyles.module.css","webpack:///./node_modules/lodash/_baseClamp.js","webpack:///./node_modules/lodash/clamp.js","webpack:///./src/Keyboard/Common/keyPositionSelectorStyles.module.css?d54d"],"sourcesContent":["\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./dragSelector.module.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./dragSelector.module.css\";\n       export default content && content.locals ? content.locals : undefined;\n","import clamp from 'lodash/clamp'\nimport compact from 'lodash/compact'\nimport { useCallback, useState, useEffect } from 'react'\n\nimport styles from './dragSelector.module.css'\n\nfunction DragSelectContainer (props) {\n  const { onMouseDown } = props\n  const { selecting, negate, rect, size } = props\n  const { children } = props\n\n  return (\n    <div\n      onMouseDown={onMouseDown}\n      className={compact([\n        styles.container,\n        selecting && styles.selecting\n      ]).join(' ')}\n    >\n      {children}\n      {selecting && (\n        <div className={compact([\n          styles.overlay,\n          negate && styles.negate\n        ]).join(' ')} style={{\n          position: 'absolute',\n          top: rect[0][1] + 'px',\n          left: rect[0][0] + 'px',\n          width: size[0] + 'px',\n          height: size[1] + 'px'\n        }} />\n      )}\n    </div>\n  )\n}\n\nexport function useDragSelector ({ polygons, onSelect }) {\n  const [state, setState] = useState({})\n\n  const handleMouseDown = useCallback(event => {\n    const offsetElement = getRelativeAncestor(event.target)\n    const rect = offsetElement.getBoundingClientRect()\n    const { clientX: x, clientY: y } = event\n\n    event.preventDefault()\n    setState({\n      start: [x, y],\n      intersecting: [],\n      offset: [rect.left, rect.top],\n      offsetRect: rect\n    })\n  }, [setState])\n\n  const handleKeyDown = useCallback(event => {\n    if (!state.selecting || event.repeat || !event.shiftKey) {\n      return\n    }\n\n    setState(state => ({ ...state, negate: true }))\n  }, [state.selecting, setState])\n\n  const handleKeyUp = useCallback(event => {\n    if (!state.negate || event.repeat || event.shiftKey) {\n      return\n    }\n\n    setState(state => ({ ...state, negate: false }))\n  }, [state.negate, setState])\n\n  const handleMouseMove = useCallback(event => {\n    const { start, offset, offsetRect } = state\n    if (!start) {\n      return\n    }\n\n    const { shiftKey, altKey, clientX, clientY } = event\n    const [x0, y0] = start\n\n    const x = clamp(clientX, offsetRect.left, offsetRect.right)\n    const y = clamp(clientY, offsetRect.top, offsetRect.bottom)\n\n    const rect = [\n      [Math.min(x, x0) - offset[0], Math.min(y, y0) - offset[1]],\n      [Math.max(x, x0) - offset[0], Math.max(y, y0) - offset[1]]\n    ]\n    const size = [\n      Math.abs(x - x0),\n      Math.abs(y - y0)\n    ]\n\n    setState(state => ({\n      ...state,\n      negate: shiftKey || altKey,\n      selecting: size[0] > 3 || size[1] > 3,\n      intersecting: getIntersectingPolygons(rect, polygons),\n      rect,\n      size\n    }))\n  }, [state, polygons, setState])\n\n  const handleMouseUp = useCallback(event => {\n    if (state.start) {\n      if (state.selecting) {\n        onSelect({\n          negate: state.negate,\n          intersecting: state.intersecting\n        })\n      }\n\n      setState({ start: null, selecting: false })\n    }\n  }, [onSelect, state, setState])\n\n  useEffect(() => {\n    window.addEventListener('mouseup', handleMouseUp)\n    window.addEventListener('mousemove', handleMouseMove)\n    window.addEventListener('keydown', handleKeyDown)\n    window.addEventListener('keyup', handleKeyUp)\n    return () => {\n      window.removeEventListener('mouseup', handleMouseUp)\n      window.removeEventListener('mousemove', handleMouseMove)\n      window.removeEventListener('keydown', handleKeyDown)\n      window.removeEventListener('keyup', handleKeyUp)\n    }\n  }, [handleMouseUp, handleMouseMove, handleKeyDown, handleKeyUp])\n\n  return [{\n    ...state,\n    onMouseDown: handleMouseDown,\n    onMouseMove: handleMouseMove\n  }, DragSelectContainer]\n}\n\nfunction getRelativeAncestor (element) {\n  // This isn't great. Iterating through ancestors is not ideal, having to check\n  // the height of the bounding client rect because I know that one of them is\n  // not going to give me the desired result is worse. This is less appropriate\n  // than using a ref, but I don't like passing it back from the hook as its\n  // \"context\" in order to pass it to the rendered component.\n  // Most likely this whole component should be a wrapper of the placed keys and\n  // using cloneElement or something, I don't know.\n  while (\n    (element = element.parentNode) &&\n    (element.style.position !== 'relative' || !element.getBoundingClientRect().height)\n  );\n\n  return element\n}\n\nfunction getIntersectingPolygons (rect, polygons) {\n  return polygons.reduce((acc, points, i) => {\n    if (points.some(({ x, y }) => (\n      rect[0][0] < x && x < rect[1][0] &&\n      rect[0][1] < y && y < rect[1][1]\n    ))) {\n      acc.push(i)\n    }\n    return acc\n  }, [])\n}\n","import compact from 'lodash/compact'\nimport { useCallback, useContext, useMemo, useReducer } from 'react'\nimport PropTypes from 'prop-types'\n\nimport { getLayoutPolygons, getWrapperStyle } from '../util'\nimport KeyboardLayout from '../KeyboardLayout'\nimport KeyWrapper from '../Keys/KeyWrapper'\n\nimport { useDragSelector } from './DragSelector'\nimport styles from './keyPositionSelectorStyles.module.css'\nimport Tip from '../../Common/Tip'\nimport { LayoutContext } from '../../Contexts/Layout'\n\nconst layoutScale = 0.2\nconst getPolygons = layout => {\n  const polygons = getLayoutPolygons(layout, { scale: layoutScale })\n  for (const polygon of polygons) {\n    for (const point of polygon) {\n      point.x *= layoutScale\n      point.y *= layoutScale\n    }\n  }\n  return polygons\n}\n\nfunction useUsageMetrics () {\n  const [state, dispatch] = useReducer((state, action) => {\n    switch (action) {\n      case 'INCREMENT_MANUAL_SELECTION':\n        return { ...state, manualSelectionCount: state.manualSelectionCount + 1 }\n      case 'INCREMENT_MANUAL_DESELECTION':\n        return { ...state, manualDeSelectionCount: state.manualDeSelectionCount + 1 }\n      case 'TRACK_DRAG_SELECTION':\n        return { ...state, usedDragSelection: true }\n      case 'TRACK_DRAG_DESELECTION':\n        return { ...state, usedDragDeSelection: true }\n      default:\n        throw new Error(`Unrecognized action type in ${action}`)\n    }\n  }, {\n    manualSelectionCount: 0,\n    manualDeSelectionCount: 0,\n    usedDragSelection: false,\n    usedDragDeSelection: false\n  })\n\n  const manualSelection = useCallback(() => dispatch('INCREMENT_MANUAL_SELECTION'), [dispatch])\n  const manualDeSelection = useCallback(() => dispatch('INCREMENT_MANUAL_DESELECTION'), [dispatch])\n  const dragSelection = useCallback(() => dispatch('TRACK_DRAG_SELECTION'), [dispatch])\n  const dragDeSelection = useCallback(() => dispatch('TRACK_DRAG_DESELECTION'), [dispatch])\n\n  return {\n    showSelectTip: !state.usedDragSelection && state.manualSelectionCount > 3,\n    showDeSelectTip: !state.usedDragDeSelection && state.manualDeSelectionCount > 3,\n    actions: {\n      manualSelection,\n      manualDeSelection,\n      dragSelection,\n      dragDeSelection\n    }\n  }\n}\n\nfunction KeyPositionSelector ({ value, prompt, onUpdate }) {\n  const { layout, wrapperDimensions } = useContext(LayoutContext)\n  const keyPolygons = useMemo(() => getPolygons(layout), [layout])\n  const wrapperStyle = useMemo(() => getWrapperStyle(wrapperDimensions, {\n    scale: layoutScale,\n    overrides: {\n      position: 'relative',\n      padding: 0,\n      margin: 0\n    }\n  }), [wrapperDimensions])\n\n  const {\n    showSelectTip,\n    showDeSelectTip,\n    actions: selectionActions\n  } = useUsageMetrics()\n\n  const handleDragSelect = useCallback(({ negate, intersecting }) => {\n    negate ? selectionActions.dragDeSelection() : selectionActions.dragSelection()\n    onUpdate(\n      negate\n        ? value.filter(i => !intersecting.includes(i))\n        : [...value, ...intersecting]\n    )\n  }, [value, onUpdate, selectionActions])\n\n  const handleSelectKey = useCallback(index => {\n    const isSelected = value.includes(index)\n    isSelected ? selectionActions.manualDeSelection() : selectionActions.manualSelection()\n\n    onUpdate(\n      isSelected\n        ? value.filter(keyPosition => keyPosition !== index)\n        : [...value, index]\n    )\n  }, [value, onUpdate, selectionActions])\n\n  const [dragProps, DragSelectContainer] = useDragSelector({\n    onSelect: handleDragSelect,\n    polygons: keyPolygons\n  })\n\n  const intersecting = dragProps.selecting\n    ? dragProps.intersecting\n    : []\n\n  const selectedIndices = value\n  const previewAddingIndices = dragProps.negate ? [] : intersecting.filter(index => !selectedIndices.includes(index))\n  const previewRemovingIndices = dragProps.negate ? intersecting.filter(index => selectedIndices.includes(index)) : []\n\n  return (\n    <div style={wrapperStyle}>\n      <DragSelectContainer {...dragProps}>\n        <KeyboardLayout\n          layout={layout}\n          bindings={[]}\n          scale={layoutScale}\n          renderKey={({ index }) => (\n            <KeyWrapper\n              onClick={() => handleSelectKey(index)}\n              themeClass={compact([\n                styles.key,\n                selectedIndices.includes(index) && styles.highlight,\n                previewAddingIndices.includes(index) && styles.previewAdd,\n                previewRemovingIndices.includes(index) && styles.previewRemove\n              ]).join(' ')}\n            />\n          )}\n        />\n        {prompt && <prompt />}\n        {showSelectTip && <Tip className={styles.tip}>Drag to select a region</Tip>}\n        {showDeSelectTip && <Tip className={styles.tip}>Shift+Drag to de-select a region</Tip>}\n      </DragSelectContainer>\n    </div>\n  )\n}\n\nKeyPositionSelector.propTypes = {\n  onUpdate: PropTypes.func.isRequired,\n  value: PropTypes.arrayOf(\n    PropTypes.number\n  ).isRequired,\n  prompt: PropTypes.node\n}\n\nexport default KeyPositionSelector\n","import PropTypes from 'prop-types'\n\nexport const position = {\n  x: PropTypes.number.isRequired,\n  y: PropTypes.number.isRequired\n}\n\nexport const rotation = {\n  a: PropTypes.number,\n  rx: PropTypes.number,\n  ry: PropTypes.number\n}\n\nexport const dimensions = {\n  u: PropTypes.number,\n  h: PropTypes.number\n}\n\nexport const keyLayout = PropTypes.shape({\n  ...position,\n  ...rotation,\n  ...dimensions\n})\n\nexport const layout = PropTypes.arrayOf(\n  keyLayout\n)\n","import pick from 'lodash/pick'\nimport PropTypes from 'prop-types'\n\nimport { getKeyStyles } from '../key-units'\nimport styles from './styles.module.css'\nimport * as layoutPropTypes from './layoutPropTypes'\n\nconst getPosition = keyLayout => pick(keyLayout, ['x', 'y'])\nconst getRotation = keyLayout => {\n  const { rx, ry, r } = keyLayout\n  return { x: rx, y: ry, a: r }\n}\nconst getSize = keyLayout => {\n  const { w = 1, u = w, h = 1 } = keyLayout\n  return { u, h }\n}\n\nfunction Placer (props) {\n  const { keyLayout, children, ...rest } = props\n  const position = getPosition(keyLayout)\n  const rotation = getRotation(keyLayout)\n  const size = getSize(keyLayout)\n  const positioningStyle = getKeyStyles(position, size, rotation)\n\n  return (\n    <div\n      className={styles.placer}\n      style={positioningStyle}\n      data-u={size.u}\n      data-h={size.h}\n      {...rest}\n    >\n      {children}\n    </div>\n  )\n}\n\nPlacer.propTypes = {\n  scale: PropTypes.number,\n  keyLayout: layoutPropTypes.keyLayout.isRequired\n}\n\nPlacer.defaultProps = {\n  scale: 1\n}\n\nexport default Placer\n","import PropTypes from 'prop-types'\n\nimport Placer from './KeyPlacer'\nimport * as layoutPropTypes from './layoutPropTypes'\n\nfunction KeyboardLayout (props) {\n  const { layout, renderKey, scale } = props\n\n  return (\n    <div style={{\n      position: 'relative',\n      transform: `scale(${scale})`,\n      transformOrigin: 0\n    }}>\n      {layout.map((keyLayout, index) => (\n        <Placer key={index} keyLayout={keyLayout}>\n          {renderKey({ index, keyLayout })}\n        </Placer>\n      ))}\n    </div>\n  )\n}\n\nKeyboardLayout.propTypes = {\n  layout: layoutPropTypes.layout.isRequired,\n  renderKey: PropTypes.func.isRequired,\n  scale: PropTypes.number\n}\n\nKeyboardLayout.defaultProps = {\n  scale: 1\n}\n\nexport default KeyboardLayout\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".eEWh1kMxq0qwtAjWodL_ {\\n  width: 100%;\\n  height: 100%;\\n  margin: 0;\\n  padding: 0;\\n}\\n\\n.eEWh1kMxq0qwtAjWodL_.Me2iewShkkUWEmhCKAJV {\\n  cursor: crosshair;\\n}\\n\\n.wou_rpm0nvB8wxB153cE {\\n  position: absolute;\\n  background-color: rgba(150, 255, 150, 0.1);\\n  border: 3px dotted rgba(150, 255, 150, 0.7);\\n  pointer-events: none;\\n  box-sizing: border-box;\\n}\\n\\n.wou_rpm0nvB8wxB153cE.fM8xQCv4KykkW5ssxgEg {\\n  background-color: rgba(120, 120, 120, 0.1);\\n  border-color: rgba(120, 120, 120, 0.25);\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/Keyboard/Common/dragSelector.module.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,WAAW;EACX,YAAY;EACZ,SAAS;EACT,UAAU;AACZ;;AAEA;EACE,iBAAiB;AACnB;;AAEA;EACE,kBAAkB;EAClB,0CAA0C;EAC1C,2CAA2C;EAC3C,oBAAoB;EACpB,sBAAsB;AACxB;;AAEA;EACE,0CAA0C;EAC1C,uCAAuC;AACzC\",\"sourcesContent\":[\".container {\\n  width: 100%;\\n  height: 100%;\\n  margin: 0;\\n  padding: 0;\\n}\\n\\n.container.selecting {\\n  cursor: crosshair;\\n}\\n\\n.overlay {\\n  position: absolute;\\n  background-color: rgba(150, 255, 150, 0.1);\\n  border: 3px dotted rgba(150, 255, 150, 0.7);\\n  pointer-events: none;\\n  box-sizing: border-box;\\n}\\n\\n.overlay.negate {\\n  background-color: rgba(120, 120, 120, 0.1);\\n  border-color: rgba(120, 120, 120, 0.25);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"container\": \"eEWh1kMxq0qwtAjWodL_\",\n\t\"selecting\": \"Me2iewShkkUWEmhCKAJV\",\n\t\"overlay\": \"wou_rpm0nvB8wxB153cE\",\n\t\"negate\": \"fM8xQCv4KykkW5ssxgEg\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".lD5TsvdIbEAHNdmhfnlb {\\n  background-color: var(--key-bg-base);\\n}\\n.yk89E4zK9zlO69OXhKn5:hover {\\n  cursor: pointer;\\n  border: 4px solid var(--selection);\\n  box-sizing: border-box;\\n}\\n\\n.pzTvsxKjpy6MqcFhxh9j {\\n  background-color: var(--selection);\\n}\\n.pzTvsxKjpy6MqcFhxh9j:hover {\\n  background-color: var(--hover-selection);\\n}\\n\\n.r_Sdklnj57CE2ZjnBDw6 {\\n  background-color: var(--hover-selection);\\n  filter: brightness(135%);\\n}\\n\\n.Ich9T1nSzHs1a84insfp {\\n  background-color: var(--hover-selection);\\n  filter: brightness(75%);\\n}\\n\\n._3U1zi1J1sXT41AzpAA1j {\\n  position: absolute;\\n  bottom: 0;\\n  right: 50%;\\n  transform: translate(50%, 100%);\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/Keyboard/Common/keyPositionSelectorStyles.module.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,oCAAoC;AACtC;AACA;EACE,eAAe;EACf,kCAAkC;EAClC,sBAAsB;AACxB;;AAEA;EACE,kCAAkC;AACpC;AACA;EACE,wCAAwC;AAC1C;;AAEA;EACE,wCAAwC;EACxC,wBAAwB;AAC1B;;AAEA;EACE,wCAAwC;EACxC,uBAAuB;AACzB;;AAEA;EACE,kBAAkB;EAClB,SAAS;EACT,UAAU;EACV,+BAA+B;AACjC\",\"sourcesContent\":[\".key {\\n  background-color: var(--key-bg-base);\\n}\\n.selectable:hover {\\n  cursor: pointer;\\n  border: 4px solid var(--selection);\\n  box-sizing: border-box;\\n}\\n\\n.highlight {\\n  background-color: var(--selection);\\n}\\n.highlight:hover {\\n  background-color: var(--hover-selection);\\n}\\n\\n.previewAdd {\\n  background-color: var(--hover-selection);\\n  filter: brightness(135%);\\n}\\n\\n.previewRemove {\\n  background-color: var(--hover-selection);\\n  filter: brightness(75%);\\n}\\n\\n.tip {\\n  position: absolute;\\n  bottom: 0;\\n  right: 50%;\\n  transform: translate(50%, 100%);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"key\": \"lD5TsvdIbEAHNdmhfnlb\",\n\t\"selectable\": \"yk89E4zK9zlO69OXhKn5\",\n\t\"highlight\": \"pzTvsxKjpy6MqcFhxh9j\",\n\t\"previewAdd\": \"r_Sdklnj57CE2ZjnBDw6\",\n\t\"previewRemove\": \"Ich9T1nSzHs1a84insfp\",\n\t\"tip\": \"_3U1zi1J1sXT41AzpAA1j\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","/**\n * The base implementation of `_.clamp` which doesn't coerce arguments.\n *\n * @private\n * @param {number} number The number to clamp.\n * @param {number} [lower] The lower bound.\n * @param {number} upper The upper bound.\n * @returns {number} Returns the clamped number.\n */\nfunction baseClamp(number, lower, upper) {\n  if (number === number) {\n    if (upper !== undefined) {\n      number = number <= upper ? number : upper;\n    }\n    if (lower !== undefined) {\n      number = number >= lower ? number : lower;\n    }\n  }\n  return number;\n}\n\nmodule.exports = baseClamp;\n","var baseClamp = require('./_baseClamp'),\n    toNumber = require('./toNumber');\n\n/**\n * Clamps `number` within the inclusive `lower` and `upper` bounds.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Number\n * @param {number} number The number to clamp.\n * @param {number} [lower] The lower bound.\n * @param {number} upper The upper bound.\n * @returns {number} Returns the clamped number.\n * @example\n *\n * _.clamp(-10, -5, 5);\n * // => -5\n *\n * _.clamp(10, -5, 5);\n * // => 5\n */\nfunction clamp(number, lower, upper) {\n  if (upper === undefined) {\n    upper = lower;\n    lower = undefined;\n  }\n  if (upper !== undefined) {\n    upper = toNumber(upper);\n    upper = upper === upper ? upper : 0;\n  }\n  if (lower !== undefined) {\n    lower = toNumber(lower);\n    lower = lower === lower ? lower : 0;\n  }\n  return baseClamp(toNumber(number), lower, upper);\n}\n\nmodule.exports = clamp;\n","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./keyPositionSelectorStyles.module.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./keyPositionSelectorStyles.module.css\";\n       export default content && content.locals ? content.locals : undefined;\n"],"names":["options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","undefined","DragSelectContainer","props","onMouseDown","selecting","negate","rect","size","children","className","compact","styles","join","style","position","top","left","width","height","useDragSelector","polygons","onSelect","useState","state","setState","handleMouseDown","useCallback","event","element","parentNode","getBoundingClientRect","getRelativeAncestor","target","x","clientX","y","clientY","preventDefault","start","intersecting","offset","offsetRect","handleKeyDown","repeat","shiftKey","handleKeyUp","handleMouseMove","altKey","x0","y0","clamp","right","bottom","Math","min","max","abs","getIntersectingPolygons","handleMouseUp","useEffect","window","addEventListener","removeEventListener","onMouseMove","reduce","acc","points","i","some","push","layoutScale","getPolygons","layout","getLayoutPolygons","scale","point","KeyPositionSelector","dispatch","manualSelection","manualDeSelection","dragSelection","dragDeSelection","value","prompt","onUpdate","useContext","LayoutContext","wrapperDimensions","keyPolygons","useMemo","wrapperStyle","getWrapperStyle","overrides","padding","margin","useReducer","action","manualSelectionCount","manualDeSelectionCount","usedDragSelection","usedDragDeSelection","Error","showSelectTip","showDeSelectTip","actions","selectionActions","handleDragSelect","filter","includes","handleSelectKey","index","isSelected","keyPosition","dragProps","selectedIndices","previewAddingIndices","previewRemovingIndices","KeyboardLayout","bindings","renderKey","KeyWrapper","onClick","themeClass","Tip","propTypes","PropTypes","isRequired","rotation","a","rx","ry","dimensions","u","h","keyLayout","getPosition","pick","getRotation","r","getSize","w","Placer","rest","positioningStyle","getKeyStyles","layoutPropTypes","defaultProps","transform","transformOrigin","map","___CSS_LOADER_EXPORT___","module","id","locals","exports","number","lower","upper","baseClamp","toNumber"],"sourceRoot":""}